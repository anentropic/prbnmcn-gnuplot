<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Plot (prbnmcn-gnuplot.Plot)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">prbnmcn-gnuplot</a> &#x00BB; Plot</nav><h1>Module <code>Plot</code></h1><p><code>prbnmcn-gnuplot</code>: a self-contained interface to Gnuplot.</p><nav class="toc"><ul><li><a href="#introduction">Introduction</a><ul><li><a href="#data:-1d,-2d,-3d">Data: 1d, 2d, 3d</a></li><li><a href="#scatter-plot-example">Scatter plot example</a></li><li><a href="#line-plot-example">Line plot example</a></li><li><a href="#histogram-example">Histogram example</a></li></ul></li><li><a href="#api">API</a><ul><li><a href="#raw-data">Raw data</a></li><li><a href="#colors,-styles,-etc">Colors, styles, etc</a></li><li><a href="#datasets">Datasets</a></li><li><a href="#plot-specifications">Plot specifications</a><ul><li><a href="#scatter-plots">Scatter plots</a></li><li><a href="#line-plots">Line plots</a></li><li><a href="#histograms">Histograms</a></li></ul></li><li><a href="#plot-rendering">Plot rendering</a></li></ul></li></ul></nav></header><section><header><h2 id="introduction"><a href="#introduction" class="anchor"></a>Introduction</h2><p>We give an introduction to the library by giving some examples. These examples can be run by performing</p><pre><code class="ml">&gt; dune exec ./test/example.exe</code></pre><p>in the root of the library.</p><p>Let's assume throughout we've access to some sampler for the standard normal distribution:</p><pre><code class="ml">val normal : Random.State.t -&gt; float</code></pre></header><section><header><h3 id="data:-1d,-2d,-3d"><a href="#data:-1d,-2d,-3d" class="anchor"></a>Data: 1d, 2d, 3d</h3><p>The library encapsulates 1d, 2d and 3d data points using the types <a href="index.html#type-r1"><code>Plot.r1</code></a>, <a href="index.html#type-r2"><code>Plot.r2</code></a> and <a href="index.html#type-r3"><code>Plot.r3</code></a>. Similarly named functions allow to inject floating-point values into these types.</p><p>As an example, we can write samplers for 2d and 3d normal variates with specified means:</p><pre><code class="ml">(** [st] is the random state *)
let normal2 (mu_x, mu_y)
  st = Plot.r2 (normal st +. mu_x) (normal st +. mu_y)</code></pre></header></section><section><header><h3 id="scatter-plot-example"><a href="#scatter-plot-example" class="anchor"></a>Scatter plot example</h3><p>Let's plot some clouds of points using <code>normal2</code>. For 2d scatter plots, we use <a href="Scatter/index.html#val-points_2d"><code>Plot.Scatter.points_2d</code></a>. We need to feed this function with a value of type <code>r2 Plot.Data.t</code>. For instance, the following function specifies a 2d scatter plot with 100 random normally distributed points with mean <code>mu</code>.</p><pre><code class="ml">let scatter ~mu st =
  Plot.Scatter.points_2d
    ~points:(Plot.Data.of_array (Array.init 100 (fun _ -&gt; normal2 mu st)))
    ()</code></pre><p>Let's produce a plot with two clouds around <code>(3, 2)</code> and <code>(10, 8)</code> and display it using the <a href="index.html#val-plot2"><code>Plot.plot2</code></a> function.</p><pre><code class="ml">let st = Random.State.make_self_init ()

let scatter2d_example =
  Plot.plot2
    ~xaxis:&quot;x&quot;
    ~yaxis:&quot;y&quot;
    ~title:&quot;Clouds&quot;
    [scatter ~mu:(3., 2.) st; scatter ~mu:(10., 8.) st]</code></pre><p>Finally, we can produce the plot and save it, say to a .png file.</p><pre><code class="ml">let () =
  let target = Plot.png ~pixel_size:(1024, 1024) ~png_file:&quot;scatter.png&quot; () in
  Plot.(run ~plot:scatter2d_example ~target exec)</code></pre><p>3d plots work similarly, using the <a href="Scatter/index.html#val-points_3d"><code>Plot.Scatter.points_3d</code></a> function.</p></header></section><section><header><h3 id="line-plot-example"><a href="#line-plot-example" class="anchor"></a>Line plot example</h3><p>The library also handles line plots, through the functions exposed in <a href="Line/index.html"><code>Plot.Line</code></a>. The API works similarly. Functions must be discretized before being plotted: for the sake of the example, let's introduce the following function.</p><pre><code class="ml">let discretize f =
  Array.init 100 (fun i -&gt;
      let x = float_of_int i *. 0.1 in
      let y = f x in
      Plot.r2 x y)</code></pre><p>We prepare a fancy plot for the discretized sine function as follows.</p><pre><code class="ml">let sine_with_points =
  let open Plot in
  Line.line_2d
    ~points:(Data.of_array (discretize sin))
    ~style:
      Style.(default |&gt; set_color Color.red |&gt; set_point ~ptyp:Pointtype.box)
    ~with_points:true
    ()</code></pre><p>We display it similarly as in the scatter plot case.</p><pre><code class="ml">let line2d_example =
  Plot.plot2 ~xaxis:&quot;x&quot; ~yaxis:&quot;y&quot; ~title:&quot;Lines&quot; [sine_with_points]

let () =
  let target = Plot.png ~pixel_size:(1024, 1024) ~png_file:&quot;lines.png&quot; () in
  Plot.(run ~plot:line2d_example ~target exec)</code></pre></header></section><section><header><h3 id="histogram-example"><a href="#histogram-example" class="anchor"></a>Histogram example</h3><p>Finally, the library allows to prepare histograms.</p><pre><code class="ml">let gaussian =
  let open Plot in
  Histogram.hist
    ~points:(Data.of_array (Array.init 100 (fun _ -&gt; r1 @@ normal st)))
    ()

let histogram_example =
  Plot.plot2 ~xaxis:&quot;x&quot; ~yaxis:&quot;freq&quot; ~title:&quot;Histogram&quot; [gaussian]

let () =
  let target = Plot.png ~pixel_size:(1024, 1024) ~png_file:&quot;histogram.png&quot; () in
  Plot.(run ~plot:histogram_example ~target exec)</code></pre><p>The binning is performed automatically by Gnuplot: currently, the API does not provide any functionality for manually specifed box plots.</p></header></section></section><section><header><h2 id="api"><a href="#api" class="anchor"></a>API</h2></header><section><header><h3 id="raw-data"><a href="#raw-data" class="anchor"></a>Raw data</h3></header><dl><dt class="spec type" id="type-r1"><a href="#type-r1" class="anchor"></a><code><span class="keyword">type</span> r1</code></dt><dd><p><code>r1, r2, r3</code> encode elements of <code>R^n</code> for <code>n</code> equal to 1, 2 or 3.</p></dd></dl><dl><dt class="spec type" id="type-r2"><a href="#type-r2" class="anchor"></a><code><span class="keyword">type</span> r2</code></dt><dt class="spec type" id="type-r3"><a href="#type-r3" class="anchor"></a><code><span class="keyword">type</span> r3</code></dt></dl><dl><dt class="spec value" id="val-r1"><a href="#val-r1" class="anchor"></a><code><span class="keyword">val</span> r1 : float <span>&#45;&gt;</span> <a href="index.html#type-r1">r1</a></code></dt><dd><p><code>r1, r2, r3</code> are injections into their respective types.</p></dd></dl><dl><dt class="spec value" id="val-r2"><a href="#val-r2" class="anchor"></a><code><span class="keyword">val</span> r2 : float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> <a href="index.html#type-r2">r2</a></code></dt><dt class="spec value" id="val-r3"><a href="#val-r3" class="anchor"></a><code><span class="keyword">val</span> r3 : float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> <a href="index.html#type-r3">r3</a></code></dt></dl></section><section><header><h3 id="colors,-styles,-etc"><a href="#colors,-styles,-etc" class="anchor"></a>Colors, styles, etc</h3></header><dl><dt class="spec module" id="module-Color"><a href="#module-Color" class="anchor"></a><code><span class="keyword">module</span> <a href="Color/index.html">Color</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Colors</p></dd></dl><dl><dt class="spec module" id="module-Pointtype"><a href="#module-Pointtype" class="anchor"></a><code><span class="keyword">module</span> <a href="Pointtype/index.html">Pointtype</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Pointtypes</p></dd></dl><dl><dt class="spec module" id="module-Fill"><a href="#module-Fill" class="anchor"></a><code><span class="keyword">module</span> <a href="Fill/index.html">Fill</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Filling shapes.</p></dd></dl><dl><dt class="spec module" id="module-Style"><a href="#module-Style" class="anchor"></a><code><span class="keyword">module</span> <a href="Style/index.html">Style</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Styles</p></dd></dl></section><section><header><h3 id="datasets"><a href="#datasets" class="anchor"></a>Datasets</h3></header><dl><dt class="spec module" id="module-Data"><a href="#module-Data" class="anchor"></a><code><span class="keyword">module</span> <a href="Data/index.html">Data</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Datasets</p></dd></dl></section><section><header><h3 id="plot-specifications"><a href="#plot-specifications" class="anchor"></a>Plot specifications</h3></header><dl><dt class="spec type" id="type-spec"><a href="#type-spec" class="anchor"></a><code><span class="keyword">type</span> <span>'dim spec</span></code></dt><dd><p><code>'dim spec</code> is the type of a declarative plot specification for data of type <code>'dim</code>.</p></dd></dl><section><header><h4 id="scatter-plots"><a href="#scatter-plots" class="anchor"></a>Scatter plots</h4></header><dl><dt class="spec module" id="module-Scatter"><a href="#module-Scatter" class="anchor"></a><code><span class="keyword">module</span> <a href="Scatter/index.html">Scatter</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Preparing scatter plots.</p></dd></dl></section><section><header><h4 id="line-plots"><a href="#line-plots" class="anchor"></a>Line plots</h4></header><dl><dt class="spec module" id="module-Line"><a href="#module-Line" class="anchor"></a><code><span class="keyword">module</span> <a href="Line/index.html">Line</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Preparing line plots.</p></dd></dl></section><section><header><h4 id="histograms"><a href="#histograms" class="anchor"></a>Histograms</h4></header><dl><dt class="spec module" id="module-Histogram"><a href="#module-Histogram" class="anchor"></a><code><span class="keyword">module</span> <a href="Histogram/index.html">Histogram</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Preparing histograms.</p></dd></dl></section></section><section><header><h3 id="plot-rendering"><a href="#plot-rendering" class="anchor"></a>Plot rendering</h3></header><dl><dt class="spec type" id="type-plot"><a href="#type-plot" class="anchor"></a><code><span class="keyword">type</span> plot</code></dt><dd><p>A <code>plot</code> consists of</p><ul><li>a choice of <code>axes</code> (2d or 3d, with a name for each axis)</li><li>a list of plot <code>spec</code>s consistent with the dimension of the <code>axes</code></li><li>a title</li></ul></dd></dl><dl><dt class="spec type" id="type-plot_matrix"><a href="#type-plot_matrix" class="anchor"></a><code><span class="keyword">type</span> plot_matrix</code><code> = </code><code>{</code><table class="record"><tr id="type-plot_matrix.plots" class="anchored"><td class="def field"><a href="#type-plot_matrix.plots" class="anchor"></a><code>plots : <span><span><span><a href="index.html#type-plot">plot</a> option</span> array</span> array</span>;</code></td></tr><tr id="type-plot_matrix.title" class="anchored"><td class="def field"><a href="#type-plot_matrix.title" class="anchor"></a><code>title : string;</code></td></tr></table><code>}</code></dt><dd><p>A <code>plot_matrix</code> represents a matrix of figures, in row-major order.</p></dd></dl><dl><dt class="spec value" id="val-plot2"><a href="#val-plot2" class="anchor"></a><code><span class="keyword">val</span> plot2 : <span>xaxis:string</span> <span>&#45;&gt;</span> <span>yaxis:string</span> <span>&#45;&gt;</span> <span>?&#8288;title:string</span> <span>&#45;&gt;</span> <span><span><a href="index.html#type-r2">r2</a> <a href="index.html#type-spec">spec</a></span> list</span> <span>&#45;&gt;</span> <a href="index.html#type-plot">plot</a></code></dt><dd><p><code>plot2 ~xaxis ~yaxis ?title specs</code> construct a 2d plot. The plots <code>specs</code> are stacked together in the same figure. All the plots share the same 2d axis system, with names <code>xaxis</code> and <code>yaxis</code>.</p></dd></dl><dl><dt class="spec value" id="val-plot3"><a href="#val-plot3" class="anchor"></a><code><span class="keyword">val</span> plot3 : <span>xaxis:string</span> <span>&#45;&gt;</span> <span>yaxis:string</span> <span>&#45;&gt;</span> <span>zaxis:string</span> <span>&#45;&gt;</span> <span>?&#8288;title:string</span> <span>&#45;&gt;</span> <span><span><a href="index.html#type-r3">r3</a> <a href="index.html#type-spec">spec</a></span> list</span> <span>&#45;&gt;</span> <a href="index.html#type-plot">plot</a></code></dt><dd><p><code>plot3 ~xaxis ~yaxis ~zaxis ~title specs</code> construct a 3d plot. The plots <code>specs</code> are stacked together in the same figure. All the plots share the same 2d axis system, with names <code>xaxis</code> and <code>yaxis</code>.</p></dd></dl><dl><dt class="spec type" id="type-target"><a href="#type-target" class="anchor"></a><code><span class="keyword">type</span> target</code></dt><dd><p>Plot target. Note that the <code>Qt</code> and <code>X11</code> targets do not work well with multiple (&quot;matrix&quot;) plots on some tiling window managers or generally when resizing windows. In this case, it is recommended to use the <code>Pdf</code> or <code>Png</code> targets and use a third-party visualizer.</p></dd></dl><dl><dt class="spec value" id="val-pdf"><a href="#val-pdf" class="anchor"></a><code><span class="keyword">val</span> pdf : <span>?&#8288;cm_size:<span>(float * float)</span></span> <span>&#45;&gt;</span> <span>pdf_file:string</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-target">target</a></code></dt><dd><p><code>pdf ?cm_size ~pdf_file ()</code> specifies that the plot should be written to the file <code>pdf_file</code> using the pdf format. The optional argument <code>?cm_size</code> specifies the width and height of the figure in <code>cm</code>. If not specified, Gnuplot will select the aspect ratio and size automatically.</p></dd></dl><dl><dt class="spec value" id="val-png"><a href="#val-png" class="anchor"></a><code><span class="keyword">val</span> png : <span>?&#8288;pixel_size:<span>(int * int)</span></span> <span>&#45;&gt;</span> <span>png_file:string</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-target">target</a></code></dt><dd><p><code>png ?pixel_size ~png_file ()</code> specifies that the plot should be written to the file <code>png_file</code> using the PNG format. The optional argument <code>?pixel_size</code> specifies the width and height of the figure in <code>pixels</code>. If not specified, Gnuplot will select the aspect ratio and size automatically.</p></dd></dl><dl><dt class="spec value" id="val-x11"><a href="#val-x11" class="anchor"></a><code><span class="keyword">val</span> x11 : <a href="index.html#type-target">target</a></code></dt><dd><p>The X11 target. This target is interactive (it will open a window).</p></dd></dl><dl><dt class="spec value" id="val-qt"><a href="#val-qt" class="anchor"></a><code><span class="keyword">val</span> qt : <span>?&#8288;pixel_size:<span>(int * int)</span></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-target">target</a></code></dt><dd><p>The qt target. This target is interactive (it will open a window). The optional argument <code>?pixel_size</code> specifies the width and height of the figure in <code>cm</code>. If not specified, Gnuplot will select the aspect ratio and size automatically.</p></dd></dl><dl><dt class="spec type" id="type-action"><a href="#type-action" class="anchor"></a><code><span class="keyword">type</span> action</code></dt><dd><p>The type of actions to perform with a plot.</p></dd></dl><dl><dt class="spec value" id="val-exec"><a href="#val-exec" class="anchor"></a><code><span class="keyword">val</span> exec : <a href="index.html#type-action">action</a></code></dt><dd><p><code>exec</code> executes the plot</p></dd></dl><dl><dt class="spec value" id="val-save_to"><a href="#val-save_to" class="anchor"></a><code><span class="keyword">val</span> save_to : string <span>&#45;&gt;</span> <a href="index.html#type-action">action</a></code></dt><dd><p><code>save_to filename</code> saves the script to <code>filename</code> (does not execute the script)</p></dd></dl><dl><dt class="spec value" id="val-exec_and_save_to"><a href="#val-exec_and_save_to" class="anchor"></a><code><span class="keyword">val</span> exec_and_save_to : string <span>&#45;&gt;</span> <a href="index.html#type-action">action</a></code></dt><dd><p><code>exec_and_save_to filename</code> executes the plot and also saves the script <code>filename</code></p></dd></dl><dl><dt class="spec value" id="val-run"><a href="#val-run" class="anchor"></a><code><span class="keyword">val</span> run : <span>?&#8288;path:string</span> <span>&#45;&gt;</span> <span>plot:<a href="index.html#type-plot">plot</a></span> <span>&#45;&gt;</span> <span>target:<a href="index.html#type-target">target</a></span> <span>&#45;&gt;</span> <a href="index.html#type-action">action</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>run ?path ~plot ~target action</code> performs <code>action</code> on <code>plot</code> using <code>target</code>.</p><ul><li>The optional argument <code>?path</code> defaults to <code>&quot;gnuplot&quot;</code>.</li></ul><p>For instance, to run some <code>plot</code> to the <code>qt</code> backend, one would perform the call:</p><pre><code class="ml">run ~plot ~target:(qt ()) exec</code></pre></dd></dl><dl><dt class="spec value" id="val-run_matrix"><a href="#val-run_matrix" class="anchor"></a><code><span class="keyword">val</span> run_matrix : <span>?&#8288;path:string</span> <span>&#45;&gt;</span> <span>plots:<span><span><span><a href="index.html#type-plot">plot</a> option</span> array</span> array</span></span> <span>&#45;&gt;</span> <span>target:<a href="index.html#type-target">target</a></span> <span>&#45;&gt;</span> <span>?&#8288;title:string</span> <span>&#45;&gt;</span> <a href="index.html#type-action">action</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>run_matrix ?path ~plots ~target action</code> performs <code>action</code> on the plot matrix <code>plots</code> using <code>target</code>.</p><ul><li>The optional argument <code>?path</code> defaults to <code>&quot;gnuplot&quot;</code>.</li><li>The optional argument <code>?title</code> specifies a title for the collection of sub-plots. It defaults to <code>&quot;&quot;</code>.</li></ul></dd></dl></section></section></div></body></html>